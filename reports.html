<<<<<<< HEAD
<style>
    /* General Resets and Typography */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f7f6;
    color: #333;
}
=======
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Donor Dashboard - Smart NGO System</title>
    <style>
        /* General Resets and Typography */
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
        }
>>>>>>> 8a68def (Changes made)

        /* Header Styling */
        header {
            background-color: #1a5632;
            color: white;
            padding: 15px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 1.5em;
            font-weight: bold;
        }

        nav a {
            color: white;
            text-decoration: none;
            margin-left: 20px;
            padding: 8px 15px;
            border-radius: 5px;
            transition: background-color 0.3s;
            font-size: 14px;
        }

        nav a:hover, nav a.active {
            background-color: #2b7049;
        }

        .donate-main-btn {
            background-color: #ff6347;
            color: white !important;
            font-weight: bold;
        }

        /* Layout: Sidebar on Left, Content on Right */
        .dashboard-layout {
            display: flex;
            min-height: calc(100vh - 80px);
        }

<<<<<<< HEAD
/* Main Content Container */
.container {
    max-width: 1000px;
    margin: 30px auto;
    padding: 0 20px;
}

/* Cause Card Styling */
.cause-card {
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.cause-title {
    color: #1a5632;
    margin-top: 0;
}

.ngo-name {
    font-size: 0.9em;
    color: #666;
    margin-bottom: 15px;
}

.description {
    line-height: 1.6;
    margin-bottom: 15px;
}

/* Progress Bar */
.progress-bar-container {
    background-color: #e0e0e0;
    border-radius: 5px;
    overflow: hidden;
    margin-bottom: 10px;
}

.progress-bar {
    height: 15px;
    background-color: #4CAF50; /* Primary success color */
    transition: width 0.4s ease;
    text-align: right;
}

/* Stats and Donate Button */
.stats {
    display: flex;
    justify-content: space-between;
    font-size: 0.95em;
    margin-bottom: 15px;
    color: #444;
}

.donate-btn {
    display: inline-block;
    background-color: #f4a261; /* Orange/Gold color for call to action */
    color: white;
    padding: 10px 15px;
    text-align: center;
    text-decoration: none;
    border-radius: 5px;
    font-weight: bold;
    transition: background-color 0.3s;
}

.donate-btn:hover {
    background-color: #e76f51;
}

/* Footer Styling */
footer {
    text-align: center;
    padding: 20px 0;
    margin-top: 50px;
    border-top: 1px solid #eee;
    color: #777;
    background-color: #fff;
}
</style>
=======
        .sidebar {
            width: 280px;
            background-color: #fff;
            padding: 30px 20px;
            border-right: 1px solid #eee;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.05);
        }

        .sidebar h2 {
            color: #1a5632;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #f4f7f6;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
        }

        .sidebar-menu li a {
            display: block;
            text-decoration: none;
            color: #555;
            padding: 12px 20px;
            margin-bottom: 8px;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
        }

        .sidebar-menu li a:hover {
            background-color: #e0f2e0;
            color: #1a5632;
        }

        .sidebar-menu li a.active-menu {
            background-color: #1a5632;
            color: white;
        }

        .dashboard-content {
            flex-grow: 1;
            padding: 40px 60px;
        }

        /* Dashboard Section Cards */
        .dashboard-section {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .dashboard-section h3 {
            color: #1a5632;
            margin-top: 0;
            margin-bottom: 25px;
            font-size: 1.4em;
            border-left: 5px solid #1a5632;
            padding-left: 15px;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th {
            background-color: #f8f9fa;
            color: #666;
            text-align: left;
            padding: 15px;
            border-bottom: 2px solid #eee;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
        }

        .receipt-link {
            color: #ff6347;
            text-decoration: none;
            font-weight: bold;
        }

        /* Forms */
        .form-group { margin-bottom: 20px; }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 15px;
        }

        .submit-btn {
            background-color: #1a5632;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: opacity 0.3s;
        }

        .submit-btn:hover { opacity: 0.9; }

        .hidden { display: none; }
    </style>
>>>>>>> 8a68def (Changes made)
</head>
<body>

<header>
<<<<<<< HEAD
    <div class="logo">Smart Donation & NGO System</div>
    <nav>
        <a href="home.html" class="active">Causes</a>
        <a href="dashboard.html">My Dashboard</a>
        <a href="admin.html">Admin Panel</a>
        <a href="reports.html">Reports</a>
        <a href="login.html">Login / Register</a>
        <a href="donate.html" class="donate-main-btn">Donate Now</a>
    </nav>
</header>
<div class="container">
    <h1>Current Donation Causes</h1>

    <div id="cause-container">
        </div>
</div>

<<<<<<< HEAD
<footer>
    <p>&copy; 2025 Smart Donation & NGO Management System</p>
</footer>
=======
        <h1>Organization Impact Dashboard</h1>
=======
    <div class="logo">Smart NGO System</div>
    <nav id="top-nav">
        <a href="home.html">Causes</a>
        <a href="dashboard.html" class="active">My Dashboard</a>
        <a href="login.html" onclick="localStorage.clear()">Logout</a>
        <a href="donate.html" class="donate-main-btn">Donate Now</a>
    </nav>
</header>

<div class="dashboard-layout">
    <aside class="sidebar">
        <h2>User Account</h2>
        <ul class="sidebar-menu">
            <li><a href="#" class="active-menu" data-target="history">Donation History</a></li>
            <li><a href="#" data-target="volunteer">Volunteer Sign-up</a></li>
            <li><a href="#" data-target="feedback">Feedback & Complaints</a></li>
            <li><a href="login.html" onclick="localStorage.clear()">Logout</a></li>
        </ul>
    </aside>

    <main class="dashboard-content">
        <h1 id="welcome-msg">Welcome back!</h1>

        <section id="history" class="dashboard-section">
            <h3>Recent Contributions</h3>
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Cause Title</th>
                        <th>Amount</th>
                        <th>Method</th>
                        <th>Receipt</th>
                    </tr>
                </thead>
                <tbody id="donation-history-body">
                    <tr><td colspan="5">Loading your history...</td></tr>
                </tbody>
            </table>
        </section>

        <section id="volunteer" class="dashboard-section hidden">
            <h3>Become a Volunteer</h3>
            <form id="volunteer-form">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="vol-name" required>
                </div>
                <div class="form-group">
                    <label>Skills (e.g., Marketing, IT)</label>
                    <input type="text" id="vol-skill" placeholder="List skills separated by commas" required>
                </div>
                <div class="form-group">
                    <label>Preferred NGO</label>
                    <select id="vol-ngo" required>
                        <option value="">Select an Organization</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Availability</label>
                    <select id="vol-avail" required>
                        <option value="Weekend">Weekends Only</option>
                        <option value="Weekday">Weekdays</option>
                        <option value="FullTime">Full Time</option>
                    </select>
                </div>
                <button type="submit" class="submit-btn">Submit Application</button>
                <p id="vol-status" style="margin-top:15px;"></p>
            </form>
        </section>

        <section id="feedback" class="dashboard-section hidden">
            <h3>Submit Feedback</h3>
            <form id="feedback-form">
                <div class="form-group">
                    <label>Target NGO</label>
                    <select id="feed-ngo" required>
                        <option value="">Select an Organization</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Type</label>
                    <select id="feed-type" required>
                        <option value="feedback">General Feedback</option>
                        <option value="complaint">Complaint</option>
                        <option value="suggestion">Suggestion</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Your Message</label>
                    <textarea id="feed-msg" rows="5" required></textarea>
                </div>
                <button type="submit" class="submit-btn">Send Feedback</button>
                <p id="feed-status" style="margin-top:15px;"></p>
            </form>
        </section>
    </main>
</div>
>>>>>>> 8a68def (Changes made)

        <section class="dashboard-grid">
            
            <div class="stat-card blue">
                <h3>Total Funds Raised</h3>
                <p class="stat-number" id="total-funds-stat">PKR 45.2M</p>
                <span class="stat-desc">SQL: <code>SUM(amount) FROM Donation</code></span>
            </div>

            <div class="stat-card green">
                <h3>Active Volunteers</h3>
                <p class="stat-number" id="active-volunteers-stat">1,240</p>
                <span class="stat-desc">SQL: <code>COUNT(*) FROM Volunteer</code></span>
            </div>

            <div class="stat-card orange">
                <h3>Highest Donation</h3>
                <p class="stat-number" id="highest-donation-stat">PKR 500,000</p>
                <span class="stat-desc">SQL: <code>MAX(amount) FROM Donation</code></span>
            </div>

        </section>

        <section class="report-panel">
            <h2>System Audit Trail (AdminLogs)</h2>
            <p>Records of critical administrative actions (e.g., Cause creation, user updates).</p>
            
            <div class="table-responsive">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Log ID</th>
                            <th>Timestamp</th>
                            <th>Actor ID</th>
                            <th>Action Performed</th>
                        </tr>
                    </thead>
                    <tbody id="audit-log-body">
                        </tbody>
                </table>
            </div>
        </section>
        
        <section class="report-panel">
            <h2> Donation Breakdown by Category</h2>
            <p>Analysis of funds collected across different cause categories.</p>
            <div class="table-responsive">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Cause Category</th>
                            <th>Transaction Count</th>
                            <th>Total Amount</th>
                            <th>Avg. Donation</th>
                        </tr>
                    </thead>
                    <tbody id="category-breakdown-body">
                        </tbody>
                </table>
            </div>
        </section>

        <section class="report-panel">
            <h2> Volunteer Assignments (Complex Join)</h2>
            <p>Lists volunteers and the specific events they are assigned to.</p>
            
            <table class="report-table">
                <thead>
                    <tr>
                        <th>Volunteer Name</th>
                        <th>Skill Set</th>
                        <th>Assigned Event</th>
                        <th>Event Date</th>
                    </tr>
                </thead>
                <tbody id="volunteer-assignments-body">
                    </tbody>
            </table>
        </section>

    </main>
>>>>>>> 22d280a (Update html files)
<script>
<<<<<<< HEAD
    // âœ… Node.js API integration

fetch("http://localhost:3000/api/causes")
  .then(res => res.json())
  .then(causes => {

    const container = document.getElementById("cause-container");

    causes.forEach(cause => {

        const progress = Math.round(
          (cause.collected / cause.goal) * 100
        );

        container.innerHTML += `
          <div class="cause-card">
              <h2 class="cause-title">${cause.title}</h2>
              <p class="ngo-name">Managed by:
                <b>${cause.ngo}</b>
              </p>
              <p class="description">${cause.description}</p>

              <div class="progress-bar-container">
                  <div class="progress-bar"
                       style="width: ${progress}%\">
                  </div>
              </div>

              <div class="stats">
                  <p>Goal: <b>PKR ${cause.goal.toLocaleString()}</b></p>
                  <p>Collected:
                    <b>PKR ${cause.collected.toLocaleString()}
                    (${progress}%)</b>
                  </p>
              </div>

              <a href="donate.html?cause_id=${cause.id}"
                 class="donate-btn">
                 Donate Now
              </a>
          </div>
        `;
    });
  })
  .catch(err => {
    console.error("Error fetching causes:", err);
    const container = document.getElementById("cause-container");
    container.innerHTML = `<p style="color: red;">Failed to load donation causes. Check server connection.</p>`;
  });
=======
document.addEventListener('DOMContentLoaded', () => {
    const token = localStorage.getItem("authToken");
    const role = localStorage.getItem("userRole");

    // 1. Session & RBAC Check
    if (!token) {
        window.location.href = "login.html";
        return;
    }

    // Update Top Nav for Staff
    if (role === 'ngo_staff') {
        const topNav = document.getElementById('top-nav');
        const logoutLink = topNav.querySelector('a[onclick*="localStorage.clear()"]');
        const adminLink = document.createElement('a');
        adminLink.href = 'admin.html';
        adminLink.textContent = 'Admin Panel';
        const reportsLink = document.createElement('a');
        reportsLink.href = 'reports.html';
        reportsLink.textContent = 'Reports';
        
        topNav.insertBefore(adminLink, logoutLink);
        topNav.insertBefore(reportsLink, logoutLink);
    }

    const authHeaders = {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${token}`
    };

    // 2. Sidebar Navigation
    const menuLinks = document.querySelectorAll(".sidebar-menu li a");
    const sections = document.querySelectorAll(".dashboard-section");

    menuLinks.forEach(link => {
        link.addEventListener("click", (e) => {
            const target = link.getAttribute("data-target");
            if (!target) return;
            e.preventDefault();

            sections.forEach(s => s.classList.add("hidden"));
            document.getElementById(target).classList.remove("hidden");

            menuLinks.forEach(l => l.classList.remove("active-menu"));
            link.classList.add("active-menu");
        });
    });

    // 3. Fetch Data: Donation History
    fetch("http://localhost:3000/api/donations/history", { headers: authHeaders })
        .then(res => res.json())
        .then(data => {
            const tbody = document.getElementById("donation-history-body");
            tbody.innerHTML = data.length ? "" : "<tr><td colspan='5'>No donations found.</td></tr>";
            
            data.forEach(item => {
                tbody.innerHTML += `
                    <tr>
                        <td>${new Date(item.date).toLocaleDateString()}</td>
                        <td><strong>${item.causeTitle}</strong></td>
                        <td>PKR ${item.amount.toLocaleString()}</td>
                        <td>${item.method}</td>
                        <td><a href="http://localhost:3000/receipts/${item.id}" class="receipt-link" target="_blank">View PDF</a></td>
                    </tr>
                `;
            });
        });

    // 4. Fetch NGOs for Forms
    fetch("http://localhost:3000/api/ngos")
        .then(res => res.json())
        .then(ngos => {
            const volSelect = document.getElementById("vol-ngo");
            const feedSelect = document.getElementById("feed-ngo");
            ngos.forEach(ngo => {
                const opt = `<option value="${ngo.id}">${ngo.name}</option>`;
                volSelect.innerHTML += opt;
                feedSelect.innerHTML += opt;
            });
        });

    // 5. Submit Volunteer Form
    document.getElementById('volunteer-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const body = {
            name: document.getElementById('vol-name').value,
            skill: document.getElementById('vol-skill').value,
            ngoId: document.getElementById('vol-ngo').value,
            availability: document.getElementById('vol-avail').value
        };

        const res = await fetch('http://localhost:3000/api/volunteer', {
            method: 'POST',
            headers: authHeaders,
            body: JSON.stringify(body)
        });

        const status = document.getElementById('vol-status');
        if (res.ok) {
            status.textContent = "Application submitted!";
            status.style.color = "green";
            e.target.reset();
        } else {
            status.textContent = "Submission failed.";
            status.style.color = "red";
        }
    });
});
>>>>>>> 8a68def (Changes made)
</script>
</body>
</html>