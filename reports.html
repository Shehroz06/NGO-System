<style>
    /* General Resets and Typography */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f7f6;
    color: #333;
}

/* Header Styling */
header {
    background-color: #1a5632; /* Deep green, reflecting Alkhidmat's branding */
    color: white;
    padding: 15px 50px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.logo {
    font-size: 1.5em;
    font-weight: bold;
}

nav a {
    color: white;
    text-decoration: none;
    margin-left: 25px;
    padding: 5px 10px;
    border-radius: 5px;
    transition: background-color 0.3s;
}

nav a:hover, nav a.active {
    background-color: #2b7049;
}

/* Donation Button Styling - ADDED FOR UNIFORMITY */
.donate-main-btn {
    background-color: #ff6347; /* Bright Tomato color */
    color: white !important; /* Ensure visibility */
    padding: 10px 20px !important;
    border-radius: 5px;
    font-weight: bold;
    text-transform: uppercase;
    margin-left: 20px; /* Separator from other links */
    transition: background-color 0.3s, transform 0.1s;
}

.donate-main-btn:hover {
    background-color: #e55338;
    transform: translateY(-1px);
}

/* Main Content Container */
.container {
    max-width: 1000px;
    margin: 30px auto;
    padding: 0 20px;
}

/* Cause Card Styling */
.cause-card {
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.cause-title {
    color: #1a5632;
    margin-top: 0;
}

.ngo-name {
    font-size: 0.9em;
    color: #666;
    margin-bottom: 15px;
}

.description {
    line-height: 1.6;
    margin-bottom: 15px;
}

/* Progress Bar */
.progress-bar-container {
    background-color: #e0e0e0;
    border-radius: 5px;
    overflow: hidden;
    margin-bottom: 10px;
}

.progress-bar {
    height: 15px;
    background-color: #4CAF50; /* Primary success color */
    transition: width 0.4s ease;
    text-align: right;
}

/* Stats and Donate Button */
.stats {
    display: flex;
    justify-content: space-between;
    font-size: 0.95em;
    margin-bottom: 15px;
    color: #444;
}

.donate-btn {
    display: inline-block;
    background-color: #f4a261; /* Orange/Gold color for call to action */
    color: white;
    padding: 10px 15px;
    text-align: center;
    text-decoration: none;
    border-radius: 5px;
    font-weight: bold;
    transition: background-color 0.3s;
}

.donate-btn:hover {
    background-color: #e76f51;
}

/* Footer Styling */
footer {
    text-align: center;
    padding: 20px 0;
    margin-top: 50px;
    border-top: 1px solid #eee;
    color: #777;
    background-color: #fff;
}
</style>
</head>
<body>

<header>
    <div class="logo">Smart Donation & NGO System</div>
    <nav>
        <a href="home.html" class="active">Causes</a>
        <a href="dashboard.html">My Dashboard</a>
        <a href="admin.html">Admin Panel</a>
        <a href="reports.html">Reports</a>
        <a href="login.html">Login / Register</a>
        <a href="donate.html" class="donate-main-btn">Donate Now</a>
    </nav>
</header>
<div class="container">
    <h1>Current Donation Causes</h1>

    <div id="cause-container">
        </div>
</div>

        <h1>Organization Impact Dashboard</h1>

        <section class="dashboard-grid">
            
            <div class="stat-card blue">
                <h3>Total Funds Raised</h3>
                <p class="stat-number" id="total-funds-stat">PKR 45.2M</p>
                <span class="stat-desc">SQL: <code>SUM(amount) FROM Donation</code></span>
            </div>

            <div class="stat-card green">
                <h3>Active Volunteers</h3>
                <p class="stat-number" id="active-volunteers-stat">1,240</p>
                <span class="stat-desc">SQL: <code>COUNT(*) FROM Volunteer</code></span>
            </div>

            <div class="stat-card orange">
                <h3>Highest Donation</h3>
                <p class="stat-number" id="highest-donation-stat">PKR 500,000</p>
                <span class="stat-desc">SQL: <code>MAX(amount) FROM Donation</code></span>
            </div>

        </section>

        <section class="report-panel">
            <h2>System Audit Trail (AdminLogs)</h2>
            <p>Records of critical administrative actions (e.g., Cause creation, user updates).</p>
            
            <div class="table-responsive">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Log ID</th>
                            <th>Timestamp</th>
                            <th>Actor ID</th>
                            <th>Action Performed</th>
                        </tr>
                    </thead>
                    <tbody id="audit-log-body">
                        </tbody>
                </table>
            </div>
        </section>
        
        <section class="report-panel">
            <h2> Donation Breakdown by Category</h2>
            <p>Analysis of funds collected across different cause categories.</p>
            <div class="table-responsive">
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Cause Category</th>
                            <th>Transaction Count</th>
                            <th>Total Amount</th>
                            <th>Avg. Donation</th>
                        </tr>
                    </thead>
                    <tbody id="category-breakdown-body">
                        </tbody>
                </table>
            </div>
        </section>

        <section class="report-panel">
            <h2> Volunteer Assignments (Complex Join)</h2>
            <p>Lists volunteers and the specific events they are assigned to.</p>
            
            <table class="report-table">
                <thead>
                    <tr>
                        <th>Volunteer Name</th>
                        <th>Skill Set</th>
                        <th>Assigned Event</th>
                        <th>Event Date</th>
                    </tr>
                </thead>
                <tbody id="volunteer-assignments-body">
                    </tbody>
            </table>
        </section>

    </main>
<script>
    // âœ… Node.js API integration

fetch("http://localhost:3000/api/causes")
  .then(res => res.json())
  .then(causes => {

    const container = document.getElementById("cause-container");

    causes.forEach(cause => {

        const progress = Math.round(
          (cause.collected / cause.goal) * 100
        );

        container.innerHTML += `
          <div class="cause-card">
              <h2 class="cause-title">${cause.title}</h2>
              <p class="ngo-name">Managed by:
                <b>${cause.ngo}</b>
              </p>
              <p class="description">${cause.description}</p>

              <div class="progress-bar-container">
                  <div class="progress-bar"
                       style="width: ${progress}%\">
                  </div>
              </div>

              <div class="stats">
                  <p>Goal: <b>PKR ${cause.goal.toLocaleString()}</b></p>
                  <p>Collected:
                    <b>PKR ${cause.collected.toLocaleString()}
                    (${progress}%)</b>
                  </p>
              </div>

              <a href="donate.html?cause_id=${cause.id}"
                 class="donate-btn">
                 Donate Now
              </a>
          </div>
        `;
    });
  })
  .catch(err => {
    console.error("Error fetching causes:", err);
    const container = document.getElementById("cause-container");
    container.innerHTML = `<p style="color: red;">Failed to load donation causes. Check server connection.</p>`;
  });
</script>
</body>
</html>